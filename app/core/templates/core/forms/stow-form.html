
{% load static %}
{% load rest_framework %}

<div class="row">
    <div class="col-12 col-md-6" id="form">
        <div class="sub-subsection-item header">
            <h5><i class="fas fa-arrow-down"></i> Stow to location</h5>
        </div>
        <hr>
        <div class="sub-subsection-item content">
            <form action="{% url 'core:StowCreateForm' %}" class="ajax-single-form" method="post" submit_button_class="submit-button" success_redirect="" status_html="#status-stow-form" paste_content_failed=".form" id="stow-form">
                {% csrf_token %}
                {% for field in form %}
                    {% if field.name == "item_fk" %}
                        <div class="field-group rounded">
                            
                            <div class="quicksearch" url="{% url 'stock:GetItems' %}" target_form="" target_field="">
                                <div class="relative">
                                        <label class="rounded">&nbsp;{{ field.label }}</label> {{ field }}
                                        <input type="text" id="name" class="input-sm form-control" placeholder="Search for item..."></input>
                                        <div class="absolute list"><ul><li>1<li><li>2</li><li>3</li></ul></div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                    <div class="field-group rounded">
                        <label class="rounded">&nbsp;{{ field.label }}</label> {{ field }}
                        {{ field.errors }}
                        {% if field.help_text %}
                            <span class="helptext">&nbsp;{{ field.help_text }}  </span>
                        {% endif %}
                    </div>             
            {% endfor %}
            <hr>
            </form>
            <div class="mt-4 mb-4">
                <a value="Proceed" class="btn btn-sm btn-primary submit-button" form="stow-form">&nbsp;Proceed</a>
                <div id="status-stow-form" class="status-html"></div>
            </div>

        </div>
    </div>
    <div class="col-12 col-md-6" id="locations">
        <div class="sub-subsection-item header">
            <h5><i class="fas fa-map-marker"></i> Locations</h5>
        </div>
        <hr>
        <div class="sub-subsection-item content">
        </div>
    </div>


<script src="{% static 'js/jquery-3.6.0.js' %}"></script>
<script src="{% static 'js/jquery-ui.js' %}"></script>
<script src="{% static 'js/ajax.js' %}"></script>
<script src="{% static 'js/csrf.js' %}"></script>
<script>

    $(".ajax-single-form").DjangoSingleAjaxForm({})
    {% comment %} $(".ajax-single-form .quicksearch").DjangoAjaxFieldContentGet({}) {% endcomment %}


    {% comment %} $("select").on("change",function() {
        console.log("sadasd")
        let $ap = $(".logs").find(".sub-subsection-item.content")
        let $label = $(this).parent().find("label")
        let $selected = $(this).val()
        $ap.append("<span><i class='fas fa-info-circle'></i> Wybrano "+$label.text()+": "+$selected+"</span><br>")

      }); {% endcomment %}
    

</script>
<script>









    $( function() {


      
      $(".quicksearch input").autocomplete({
        //source : ["odaaaaaa","opoppsdpad"],



        source: function( request, response ) {
          $.ajax( {
            url: "{% url 'stock:GetItems' %}",
            dataType: "json",
            data: {
              name: request.term
            },
            success: function(data) {
                js = JSON.parse(data.json)
                //js = JSON.parse('[{"label":"asd","value":1,"label":"xzc","value":2}]')
                //$(this).val(js.id)
                response(js);
                console.log(js)
            }
          } );
        },


        minLength: 1,
        select: function( event, ui ) {
            
            console.log(ui.item.value)
            console.log(ui.item.label)
            console.log(ui)
            return false;

        }
      } );
    } );
    </script>
